services:
  frontend:
    image: nginx:alpine
    container_name: demo_frontend
    volumes:
      - ./frontend/nginx.conf:/etc/nginx/conf.d/default.conf:ro
    ports:
      - "8080:80"              
      - app
    networks:
      - front_net

  app:
    build: ./app
    container_name: demo_app
    expose:
      - "8080"                  
    environment:
      - BACKEND_URL=http://backend:5000/data
    depends_on:
      - backend
    networks:
      - front_net
      - back_net

  backend:
    build: ./backend
    container_name: demo_backend
    expose:
      - "5000"
    networks:
      - back_net

networks:
  front_net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.31.10.0/24
  back_net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.31.20.0/24
